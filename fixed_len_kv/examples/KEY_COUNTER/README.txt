This code needs some serious cleanup.
At this point, I am not even sure what the heck it is doing here! :-)
